"use strict";var question={},questionStart=(new Date).getTime(),subjectDefinitions={je:"I",tu:"You",il:"He",elle:"She",on:"One",nous:"We",vous:"You",ils:"They (masculine)",elles:"They (feminine)"},tenseDefinitions={pr:"Present tense",pc:"Past tense",pp:"Past perfect tense",ps:"Past tense (literature)",im:"Imperfect past (past state or ongoing action)",fs:"Future tense (intentions, predictions, conditional)",fa:"Future tense (actions previous to another)",co:"Conditional tense",cp:"Past conditional tense (regrets, what would / could have happened)",su:"Subjunctive Tense (opinions, emotions, and possibilities)",sp:"Past of the Subjunctive Tense (opinions, emotions, and possibilities)"},vowels=["a","e","i","o","u","y"];function showQuestion(e){question=e,questionStart=(new Date).getTime(),$("#vite-q-verb, #vite-q-tense").addClass("notranslate"),$("#vite-q-verb").text(e.verb),$("#vite-q-tense").text(e.tense),$("#vite-q-tense").attr("tenseshort",e.tenseShort),$("#vite-q-verb").attr("info",e.definition),$("#vite-q-subject").attr("info",subjectDefinitions[e.subject.toLowerCase()]),e.tense.includes("Subjonctif")&&["e","i","o"].includes(e.subject[0].toLowerCase())?$("#vite-q-prefix").html("qu'"):e.tense.includes("Subjonctif")?$("#vite-q-prefix").html("que&nbsp;"):$("#vite-q-prefix").html(""),$("#vite-q-tense").attr("info",tenseDefinitions[e.tenseShort]),$("#vite-q-subject").text(e.subject),$("#vite-q-prompt").outerHeight()>28?$("#vite-q-prompt").css({"margin-bottom":73-$("#vite-q-prompt").outerHeight()}):$("#vite-q-prompt").css({"margin-bottom":""}),$("#vite-q-subject").addClass("notranslate"),null!=e.fullsize?$("#answer-mascot").attr("mood","full="+e.fullsize):$("#answer-mascot").attr("mood","mood="+e.mascot)}function submitAnswer(e=!1){if(document.body.hasAttribute("showanswer")){$(document.body).removeAttr("showanswer avaliable result"),$("#next-button").removeClass("avaliable");let e=("all"==scoringData.countAll?score.total:score.correct)/scoringData.target;NaN!=scoringData.target&&null!=scoringData.countAll&&e>=1?$("form[name='practice-results']").submit():showQuestion(new Conjugate),$("#answer-input").val("")}else{$(document.body).attr("showanswer","");let s=$("#answer-input").val().toLowerCase();for(;" "==s.charAt(s.length-1);)s=s.slice(0,-1);variations(question.answer.alt).includes(s)||variations(question.answer.full).includes(s)?(changeScore(1),$("#answer-correction-1, #answer-correction-2").text(""),$(document.body).attr("result","correct")):(changeScore(-1),$(document.body).attr("result","incorrect"),$("#answer-correction-1").text(question.answer.alt),$("#answer-correction-2").text(question.answer.full),$("#answer-correction-1, #answer-correction-2").addClass("notranslate")),e&&$(document.body).attr("result","skipped")}}function variations(e){return[e.replace("(e)",""),e.replace("(s)",""),e.replace("(e)","").replace("(s)",""),e.replace("(e)","e"),e.replace("(s)","s"),e.replace("(e)","e").replace("(s)","s")]}class Conjugate{constructor(e={tense:this.random(split("tenses")),subject:this.random(split("subjects")),verb:this.random(split("verbs"))}){return this.tense=e.tense,this.subject=e.subject,this.verb={name:e.verb,verb:verbs[e.verb]},this.conjugate(this.tense,this.subject,this.verb)}random(e){return"object"==typeof e?e[parseInt(Math.random()*e.length)]:"number"==typeof e?parseInt(Math.random()*e):Math.random()}conjugate(e,s,t){let n=e;t.name.includes("Conna")&&(t.verb=verbs["Connaître"]);let r={};switch(e){case"pr":r=this.prTense(s,t),e="Présent";break;case"pc":r=this.pcTense(s,t),e="Passé Composé";break;case"ps":r=this.psTense(s,t),e="Passé Simple";break;case"im":r=this.imTense(s,t),e="Imparfait";break;case"fs":r=this.fsTense(s,t),e="Futur Simple";break;case"fa":r=this.faTense(s,t),e="Futur Antérieur";break;case"co":r=this.coTense(s,t),e="Conditionnel";break;case"cp":r=this.cpTense(s,t),e="Conditionnel Passé";break;case"pp":r=this.ppTense(s,t),e="Plus que Parfait";break;case"su":r=this.suTense(s,t),e="Subjonctif";break;case"sp":r=this.spTense(s,t),e="Subjonctif Passé";break;default:return console.error(`Could not match requested tense "${e}" to method`),{subject:r.subject,verb:t.name,tense:"error: could not be matched",tenseShort:"error",answer:{alt:"error",full:"error"},definition:t.verb.definition,mascot:t.verb.mascot,fullsize:t.verb.fullsize}}return{subject:r.subject,verb:t.name,tense:e,tenseShort:n,answer:{alt:r.alt,full:r.full},definition:t.verb.definition,mascot:t.verb.mascot,fullsize:t.verb.fullsize}}compress(e){for(let s of vowels)e=e.replace("je "+s,"j'"+s).replace("je h"+s,"j'h"+s);return e}versions(e,s,t=!1){let n={alt:e.toLowerCase()};return n.subject=t?s:this.agreement(s).subject,n.full=this.compress([n.subject,n.alt].join(" ").toLowerCase()),n}prTense(e,s){let t,n={ir:{Je:"is",Tu:"is","Il / Elle / On":"it",Nous:"issons",Vous:"issez","Ils / Elles":"issent"},re:{Je:"s",Tu:"s","Il / Elle / On":"",Nous:"ons",Vous:"ez","Ils / Elles":"ent"},er:{Je:"e",Tu:"es","Il / Elle / On":"e",Nous:"ons",Vous:"ez","Ils / Elles":"ent"}};if(t=s.verb[e],"regular"==t||"regular"==s.verb.All||1==s.verb.regular){let r=s.name.substr(0,s.name.length-2),i=s.name.substr(-2);Object.keys(n).includes(i)?("er"==i&&("y"==r.substr(-1)&&"ay"!=r.substr(-2)?r=r.substr(0,r.length-1)+"i":"e"==r.substr(-2,1)&&["l","t"].includes(r.substr(-1))&&"Acheter"!=s.name?r+=r.substr(-1):!["e","é"].includes(r.substr(-2,1))||vowels.includes(r.substr(-1))||["Nous","Vous"].includes(e)||(r=r.substr(0,r.length-2)+"è"+r.substr(-1))),t=r+n[i][e]):window.alert("ERR: Cannot find regular ending for verb with non-ir/er/re ending marked as regular")}return this.versions(t,e)}psTense(e,s){let t,n={Je:"is",Tu:"is","Il / Elle / On":"it",Nous:"îmes",Vous:"îtes","Ils / Elles":"irent"},r={Je:"ai",Tu:"as","Il / Elle / On":"a",Nous:"âmes",Vous:"âtes","Ils / Elles":"èrent"},i=s.name.substr(0,s.name.length-2);return"regular"==s.verb.PS.All?"er"==s.name.substr(-2)?t=i+r[e]:"ir"!=s.name.substr(-2)&&"re"!=s.name.substr(-2)||(t=i+n[e]):t=s.verb.PS[e],this.versions(t,e)}pcTense(e,s){let t={helping:verbs[s.verb.PC.helping][e]};return"regular"===s.verb.PC.participle?(t.base=s.name.substr(0,s.name.length-2),t.end=s.name.substr(-2),"er"===t.end?t.end="é":"re"===t.end?t.end="u":"ir"===t.end?t.end="i":window.alert("errored while conjugating a verb marked as regular, but with no acceptable ending"),t.participle=t.base+t.end):t.participle=s.verb.PC.participle,t.agreement=this.agreement(e),t.subject=t.agreement.subject,"Avoir"==s.verb.PC.helping||(t.participle=t.participle+t.agreement.agreement),t.answer=[t.helping,t.participle].join(" ").toLowerCase(),1==arguments[2]?{participle:t.participle,subject:t.subject}:this.versions(t.answer,e)}imTense(e,s,t){let n,r={Je:"ais",Tu:"ais","Il / Elle / On":"ait",Nous:"ions",Vous:"iez","Ils / Elles":"aient"};return"Être"==s.name?n="ét"+r[e]:(n=this.prTense("Nous",s).alt,n=n.substr(0,n.length-3)+r[e]),1==t?{a:n,s:e}:this.versions(n,e)}fsTense(e,s){let t="regular"==s.verb.FS?s.name:s.verb.FS;"re"==t.substr(-2)&&(t=t.substr(0,t.length-1));let n=[t,{Je:"ai",Tu:"as","Il / Elle / On":"a",Nous:"ons",Vous:"ez","Ils / Elles":"ont"}[e]].join("").toLowerCase();return this.versions(n,e)}faTense(e,s){let t=this.fsTense(e,{name:s.verb.PC.helping,verb:verbs[s.verb.PC.helping]});return t.participle=this.pcTense(e,s,!0).participle,t.full+=(" "+t.participle).toLowerCase(),t.alt+=(" "+t.participle).toLowerCase(),t}coTense(e,s,t){let n="regular"==s.verb.FS?s.name:s.verb.FS;"re"==n.substr(n.length-2,2)&&(n=n.substr(0,n.length-1));let r=(n+{Je:"ais",Tu:"ais","Il / Elle / On":"ait",Nous:"ions",Vous:"iez","Ils / Elles":"aient"}[e]).toLowerCase();return 1==t?{a:r,s:e}:this.versions(r,e)}cpTense(e,s){let t={};return t.coHelping=this.coTense(e,{name:s.verb.PC.helping,verb:verbs[s.verb.PC.helping]},!0).a,t.pc=this.pcTense(e,s,!0),this.versions([t.coHelping,t.pc.participle].join(" "),t.pc.subject,!0)}ppTense(e,s){let t={};return t.imHelping=this.imTense(e,{name:s.verb.PC.helping,verb:verbs[s.verb.PC.helping]},!0).a,t.pc=this.pcTense(e,s,!0),this.versions([t.imHelping,t.pc.participle].join(" "),t.pc.subject,!0)}suTense(e,s,t){let n,r,i={Je:"e",Tu:"es","Il / Elle / On":"e",Nous:"ions",Vous:"iez","Ils / Elles":"ent"};return"regular"==s.verb.SU||"regular"==s.verb.SU[e]?(r=this.prTense("Ils / Elles",s).alt,"ent"==r.substr(r.length-3,3)?(r=r.substr(0,r.length-3),n=r+i[e]):window.alert(`ERR: Could not remove -ent ending from présent tense of 'Ils / Elles' conjugation ('${r}'), cannot form Subjonctif`)):n=s.verb.SU[e],1==t?{a:n,s:e}:this.versions(n,e)}spTense(e,s){let t={};return t.coHelping=this.suTense(e,{name:s.verb.PC.helping,verb:verbs[s.verb.PC.helping]},!0).a,t.pc=this.pcTense(e,s,!0),this.versions([t.coHelping,t.pc.participle].join(" "),t.pc.subject,!0)}agreement(e){let s={agreement:""};return s.subject=this.random(e.toLowerCase().split(" / ")),["elle","elles"].includes(s.subject)?s.agreement+="e":["il","ils"].includes(s.subject)||(s.agreement+="(e)"),["ils","elles","nous"].includes(s.subject)?s.agreement+="s":"vous"==s.subject&&(s.agreement+="(s)"),s}}
