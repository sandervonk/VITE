"use strict";var calJSON;function getCalendarHTML(t,e,a){let r=`<div id="streak-calendar" date="${t.toDateString()}">`,n=new Date(t.getFullYear(),t.getMonth(),1),l=new Date(t.getFullYear(),t.getMonth()+1,0),d=0,o=[[0,"empty",""],[0,"empty",""],[0,"empty",""],[0,"empty",""],[0,"empty",""],[0,"empty",""]];r+=`<div id="streak-calendar-head"> <button class="calendar-button" id="cal-month-prev"></button> <div id="streak-month">${n.toLocaleString("en-us",{month:"long"})+(n.getFullYear()==(new Date).getFullYear()?"":" <span class='cal-year'>"+n.getFullYear())+"</span>"}</div> <button class="calendar-button" id="cal-month-next"></button> </div>`,r+='<div id="streak-days">',d=n.getDay();for(let t=d;t<l.getDate()+d;t++){let r=e[(c=n.setDate(1-d+t),c=new Date(c),[String(c.getMonth()+1).padStart(2,"0"),String(c.getDate()).padStart(2,"0"),c.getFullYear()].join("-"))],l=r||0;o[t]=[l,l>=a?"streak":r>=0?"login":"none",t-d+1]}var c;for(let t=0;t<o.length;t++){let e=Array.from(o[t]);o[t-1]&&o[t][1]==o[t-1][1]&&t%7!=0&&(e[1]+=" connect-left"),o[t+1]&&o[t][1]==o[t+1][1]&&t%7!=6&&(e[1]+=" connect-right"),r+=`<div class="calendar-day day-${e[1]}" title="${e[0]} xp" xp="${e[0]}">${e[2]}</div>`}return r+="</div></div>",r}$(document).on("click","body:not([header-collapsed]) [streak='calendar']",(t=>{calJSON=JSON.parse(localStorage.getItem("userData")),$("#streak-overlay").remove(),$(document.body).append('<div id="streak-overlay" class="center">'+getCalendarHTML(new Date,calJSON.xphistory,calJSON.goal)+"</div>"),$("#streak-overlay").addClass("fadein"),$("#streak-calendar").addClass("fadezoomin")})),$(document.body).on("click","#streak-overlay",(t=>{"streak-overlay"==t.target.id&&($("#streak-overlay").addClass("fadeout"),$("#streak-calendar").addClass("fadezoomout"))})),$(document.body).on("click",".calendar-button",(t=>{let e=0;"cal-month-prev"==t.target.id?e=-1:"cal-month-next"==t.target.id&&(e=1);let a=$("#streak-calendar"),r=new Date(a.attr("date")).setMonth(new Date(a.attr("date")).getMonth()+e);a.attr("date",new Date(r).toDateString()),a.html(getCalendarHTML(new Date(a.attr("date")),calJSON.xphistory,calJSON.goal))}));
